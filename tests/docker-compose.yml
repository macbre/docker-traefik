version: "3.2"

services:
  nginx:
    # https://github.com/macbre/docker-nginx-http3
    image: ghcr.io/macbre/nginx-http3:1.23.2
    ports:
      - "5555:5555"
    volumes:
      - "./nginx-static.conf:/etc/nginx/conf.d/nginx-static.conf"
    # user: nobody

    labels:
      traefik.enable: true
      traefik.http.routers.wordpress.tls.certresolver: letsencrypt
      traefik.http.routers.wordpress.rule: Host(`nginx.foo.bar`)
      traefik.http.services.wordpress.loadbalancer.server.port: 5555

    healthcheck:
      test: 'wget --spider 0:5555'
      interval: 1s
      timeout: 1s
      retries: 2

networks:
  default:
    name: public-network
    external: true
